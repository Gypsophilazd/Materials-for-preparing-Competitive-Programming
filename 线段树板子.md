```
#define int long long

#define ls o << 1

#define rs o << 1 | 1

const int N = 1e5 + 5;

int a[N] = {0};

struct Segment_Tree{

    struct Node{int l,r,sum,add;}t[N<<2];

    int mp[N];

    void pushup(int o){t[o].sum=t[ls].sum+t[rs].sum;}

    void build(int st,int ed,int o){

        t[o].l=st,t[o].r=ed;

        if(st==ed){

            t[o].sum=a[st],mp[st]=o;

            return ;

        }

        int mid=(st+ed)>>1;

        build(st,mid,ls);build(mid+1,ed,rs);

        pushup(o);

    }

    void pushdown(int o){

        if(t[o].add){

            t[ls].sum+=t[o].add*(t[ls].r-t[ls].l+1);

            t[rs].sum+=t[o].add*(t[rs].r-t[rs].l+1);

            t[ls].add+=t[o].add,t[rs].add+=t[o].add;

            t[o].add=0;

        }

    }

    void update(int x,int y,int k,int o){

        if(t[o].r<x||t[o].l>y) return ;

        if(x<=t[o].l&&t[o].r<=y){

            t[o].sum+=(t[o].r-t[o].l+1)*k;

            t[o].add+=k;

            return ;

        }

        pushdown(o);

        update(x,y,k,ls),update(x,y,k,rs);

        pushup(o);

    }

    int query(int x,int y,int o){

        if(t[o].r<x||t[o].l>y) return 0;

        if(x<=t[o].l&&t[o].r<=y) return t[o].sum;

        pushdown(o);

        return query(x,y,ls)+query(x,y,rs);

    }

    void modify(int x,int y){

        x=mp[x],t[x].sum+=y;

        while(x>>=1) pushup(x);

    }

}ST;

```